CREATE SCHEMA COMPANY;

CREATE TABLE EMPLOYEE (
	FNAME		VARCHAR(15) 	NOT NULL,
	MINIT		CHAR,
	LNAME		VARCHAR(15)	NOT NULL,
	SSN		CHAR(9),
	BDATE		DATE,
	ADDRESS		VARCHAR(30),
	SEX		CHAR,
	SALARY 		DECIMAL(10,2),
	SUPER_SSN	CHAR(9),
	DNO		INT		NOT NULL,
	PRIMARY KEY (SSN),
	FOREIGN KEY (SUPER_SSN) REFERENCES EMPLOYEE (SSN) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE DEPENDENT (
	ESSN		CHAR(9),
	DEPENDENT_NAME	VARCHAR(15),
	SEX		CHAR,
	BDATE		DATE,
	RELATIONSHIP	VARCHAR(8),
	PRIMARY KEY (ESSN, DEPENDENT_NAME),
	FOREIGN KEY (ESSN) REFERENCES EMPLOYEE (SSN) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE DEPARTMENT (
	DNAME		VARCHAR(15)	NOT NULL,
	DNUMBER 	INT,
	MGR_SSN		CHAR(9)		NULL,
	MGR_START_DATE	DATE,
	PRIMARY KEY (DNUMBER),
	UNIQUE (DNAME),
	FOREIGN KEY (MGR_SSN) REFERENCES EMPLOYEE (SSN) ON DELETE SET NULL ON UPDATE CASCADE
);

CREATE TABLE DEPT_LOCATIONS (
	DNUMBER 	INT,
	DLOCATION	VARCHAR(15),
	PRIMARY KEY (DNUMBER, DLOCATION),
	FOREIGN KEY (DNUMBER) REFERENCES DEPARTMENT(DNUMBER) ON DELETE CASCADE ON UPDATE CASCADE
);

ALTER TABLE EMPLOYEE 
ADD FOREIGN KEY (DNO) REFERENCES DEPARTMENT (DNUMBER) ON DELETE CASCADE ON UPDATE CASCADE;

CREATE TABLE PROJECT (
	PNAME		VARCHAR(15)	NOT NULL,
	PNUMBER		INT,
	PLOCATION 	VARCHAR(15),
	DNUM		INT		NOT NULL,
	PRIMARY KEY (PNUMBER),
	UNIQUE (PNAME),
	FOREIGN KEY (DNUM) REFERENCES DEPARTMENT (DNUMBER) ON DELETE CASCADE ON UPDATE CASCADE
);

CREATE TABLE WORKS_ON (
	ESSN	CHAR(9),
	PNO	INT,
	HOURS	DECIMAL(3,1),
	PRIMARY KEY (ESSN, PNO),
	FOREIGN KEY (ESSN) REFERENCES EMPLOYEE (SSN) ON DELETE CASCADE ON UPDATE CASCADE,
	FOREIGN KEY (PNO) REFERENCES PROJECT (PNUMBER) ON DELETE CASCADE ON UPDATE CASCADE
);


